(this["webpackJsonpreact_people-table-advanced"]=this["webpackJsonpreact_people-table-advanced"]||[]).push([[0],{22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var c=n(12),a=n.n(c),r=n(6),s=(n(19),n(20),n(1)),i=n.n(s),l=n(3),d=n(4),o=function(){return e="/people.json",fetch("".concat("https://mate-academy.github.io/react_people-table/api").concat(e)).then((function(e){if(!e.ok)throw new Error("".concat(e.status," - ").concat(e.statusText));return e.json()}));var e},j=n(0),b=i.a.createContext({people:[],setPeople:function(){}}),u=function(e){var t=e.children,n=Object(s.useState)([]),c=Object(d.a)(n,2),a=c[0],r=c[1];Object(s.useEffect)((function(){o().then(r)}),[]);var i={people:a,setPeople:r};return Object(j.jsx)(b.Provider,{value:i,children:t})},m=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("header",{className:"header",children:Object(j.jsx)("div",{className:"container is-fluid",children:Object(j.jsx)("nav",{className:"tabs",children:Object(j.jsxs)("ul",{children:[Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsx)(r.c,{to:"/",children:"Home"})}),Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsx)(r.c,{to:"/people",children:"People"})})]})})})}),Object(j.jsx)("section",{className:"section",children:Object(j.jsx)("div",{className:"container is-fluid",children:Object(j.jsx)(l.a,{})})}),Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("h2",{children:"Made in Ukraine @ 2022"})})]})},h=function(){return Object(j.jsx)("h1",{children:"Welcome to the advanced people task"})},O=n(2),x=n(10),f=n.n(x),p=n(13),N=function(e){var t=e.person,n=Object(l.h)().personId,c=Object(l.f)().search;return Object(j.jsx)(p.a,{selector:"#".concat(t.slug),smooth:!0,scrollOptions:{block:"center"},children:Object(j.jsx)(r.b,{to:n===t.slug?{pathname:"/people",search:c}:{pathname:"/people/".concat(t.slug),search:c},style:{color:"m"===t.sex?"rgb(0, 71, 171)":"rgb(255, 0, 0)"},children:t.name})})},v=(n(22),function(e){var t=e.person,n=e.sortBy,c=Object(s.useContext)(b),a=c.people,r=c.setPeople,i=Object(s.useState)(!1),l=Object(d.a)(i,2),o=l[0],u=l[1];return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("td",{id:"".concat(t.slug),className:"name"===n?"sorted-cell cell":"cell",style:{display:"flex",justifyContent:"space-between"},onMouseOver:function(){return u(!0)},onMouseLeave:function(){return u(!1)},onFocus:function(){return u(!0)},onBlur:function(){return u(!1)},children:[Object(j.jsx)(N,{person:t}),o&&Object(j.jsx)("div",{className:"deleteUser",children:Object(j.jsx)("button",{type:"button",className:"deleteButton",onClick:function(){r(a.filter((function(e){return e.slug!==t.slug})))},children:"X"})})]}),Object(j.jsx)("td",{className:"sex"===n?"sorted-cell":"",children:"m"===t.sex?"Male":"Female "}),Object(j.jsx)("td",{className:"born"===n?"sorted-cell":"",children:t.born}),Object(j.jsx)("td",{className:"died"===n?"sorted-cell":"",children:t.died}),Object(j.jsxs)("td",{children:[t.mother?Object(j.jsx)(N,{person:t.mother}):Object(j.jsx)("b",{children:t.motherName}),!t.motherName&&"-"]}),Object(j.jsxs)("td",{children:[t.father?Object(j.jsx)(N,{person:t.father}):Object(j.jsx)("b",{children:t.fatherName}),!t.fatherName&&"-"]})]})}),g=(n(23),function(e){var t=e.people,n=Object(l.h)().personId,c=Object(r.d)(),a=Object(d.a)(c,2),s=a[0],i=a[1],o=s.get("query")||"",b=s.get("sortBy")||"",u=s.get("sortOrder")||"",m=t.map((function(e){var n=t.find((function(t){return t.name===e.fatherName})),c=t.find((function(t){return t.name===e.motherName}));return Object(O.a)(Object(O.a)({},e),{},{mother:c,father:n})})),h=b?m.sort((function(e,t){switch(b){case"name":case"sex":return"asc"===u?e[b].localeCompare(t[b]):t[b].localeCompare(e[b]);case"born":case"died":return"asc"===u?+e[b]-+t[b]:+t[b]-+e[b];default:return 0}})):m;return Object(j.jsxs)("table",{className:"table is-bordered is-fullwidth",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[["Name","Sex","Born","Died"].map((function(e){return Object(j.jsx)("th",{className:f()("sorted-column",{"sorted-column__asc":b===e.toLowerCase()&&"asc"===u,"sorted-column__desc":b===e.toLowerCase()&&"desc"===u}),onClick:function(e){!function(e){var t,n=null===(t=e.currentTarget.textContent)||void 0===t?void 0:t.toLowerCase(),c={};o&&(c.query=o),n&&b!==n?(c.sortBy=n,c.sortOrder="asc"):n&&"asc"===u?(c.sortBy=n,c.sortOrder="desc"):n&&"desc"===u&&(c.sortBy=n,c.sortOrder="asc"),i(c)}(e)},children:e},e)})),Object(j.jsx)("th",{children:"Mother"}),Object(j.jsx)("th",{children:"Father"})]})}),Object(j.jsx)("tbody",{children:h.map((function(e){return Object(j.jsx)("tr",{className:f()({"is-selected":n===e.slug}),children:Object(j.jsx)(v,{person:e,sortBy:b})},e.slug)}))})]})}),y=(n(24),function(){var e=Object(l.h)().personId,t=Object(s.useContext)(b).people,n=Object(r.d)(),c=Object(d.a)(n,2),a=c[0],i=c[1],o=a.get("query")||"",u=a.get("sortBy")||"",m=a.get("sortOrder")||"",h=Object(s.useState)(o),O=Object(d.a)(h,2),x=O[0],f=O[1],p=Object(s.useCallback)(function(e,t){var n;return function(){clearTimeout(n);for(var c=arguments.length,a=new Array(c),r=0;r<c;r++)a[r]=arguments[r];n=setTimeout.apply(void 0,[e,t].concat(a))}}((function(e){var t={};return e&&(t.query=e),u&&(t.sortBy=u),m&&(t.sortOrder=m),i(t)}),800),[e,u,m]),N=x?t.filter((function(e){var t=e.name,n=e.motherName,c=e.fatherName;return t.toLowerCase().includes(o)||(null===n||void 0===n?void 0:n.toLowerCase().includes(o))||(null===c||void 0===c?void 0:c.toLowerCase().includes(o))})):t;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"field",children:[Object(j.jsxs)("p",{className:"control has-icons-left",children:[Object(j.jsx)("input",{type:"text",className:"input",value:x,onChange:function(e){f(e.target.value),p(e.target.value)},"data-cy":"filterInput"}),Object(j.jsx)("span",{className:"icon is-small is-left",children:Object(j.jsx)("i",{className:"fas fa-search"})})]}),Object(j.jsx)("div",{className:"button-box",children:Object(j.jsx)(r.b,{to:"/people/new",className:"button is-primary level",children:"Add new person"})})]}),t.length>0&&Object(j.jsx)(g,{people:N})]})}),F=n(14),q=n(8),M=(n(25),function(){var e=Object(s.useContext)(b),t=e.people,n=e.setPeople,c=Object(l.g)(),a=t.filter((function(e){return"m"===e.sex})),r=t.filter((function(e){return"f"===e.sex})),i=Object(s.useState)({name:"",nameInit:!1,sex:"",sexInit:!1,born:"",bornInit:!1,died:"",diedInit:!1,motherName:"default",fatherName:"default",mother:null,father:null}),o=Object(d.a)(i,2),u=o[0],m=o[1],h=Object(s.useState)({bornMin:!1,bornMax:!1,diedMin:!1,diedMax:!1,bornDied:!1,lifeExpectancy:!1,requiredFieldName:!1,requiredFieldSex:!1,requiredFieldBorn:!1,requiredFieldDied:!1,canSubmit:!1}),x=Object(d.a)(h,2),p=x[0],N=x[1],v={bornMin:"The birth year cannot be less than 1400",bornMax:"The birth year cannot be more than current year",diedMin:"Mininum death year is ".concat(u.born),diedMax:"Maximum died year is ".concat((new Date).getFullYear()),bornDied:"Death cannot happen before birth",lifeExpectancyMax:"Life expectancy shouldn't be more that 150 years",requiredField:"This field is required"};Object(s.useEffect)((function(){var e=u.name,t=u.nameInit,n=u.sex,c=u.sexInit,a=u.born,r=u.bornInit,s=u.died,i=u.diedInit;N(Object(O.a)(Object(O.a)({},p),{},{bornMin:!!(+a<1400&&r),bornMax:+a>(new Date).getFullYear(),diedMin:!!(+a>+s&&i),diedMax:+s>(new Date).getFullYear(),bornDied:+s<+a,lifeExpectancy:!!(+s-+a>150&&r),requiredFieldName:!(""!==e||!t),requiredFieldSex:!(""!==n||!c),requiredFieldBorn:!(!r||0!==+a),requiredFieldDied:!(!i||0!==+s)}))}),[u.born,u.died,u.name,u.sex]);var g=function(e){var t=e.target,n=t.name,c=t.value;switch(n){case"born":case"died":return m(Object(O.a)(Object(O.a)({},u),{},Object(q.a)({},n,+c)));case"name":return c.match(/^[a-zA-Z\s]*$/g)&&m(Object(O.a)(Object(O.a)({},u),{},Object(q.a)({},n,c)));default:return m(Object(O.a)(Object(O.a)({},u),{},Object(q.a)({},n,c)))}},y=r.filter((function(e){return+u.born>e.born})),M=a.filter((function(e){return+u.born>e.born}));return Object(j.jsx)("div",{className:"box",children:Object(j.jsxs)("form",{className:"form",onSubmit:function(e){e.preventDefault();var a={slug:u.name.trim().toLowerCase().split(" ").join("-").concat("-".concat(u.born)),name:u.name.trim(),sex:u.sex,born:+u.born,died:+u.died,motherName:"default"===u.motherName?null:u.motherName,fatherName:"default"===u.fatherName?null:u.fatherName,mother:t.find((function(e){return e.name===u.motherName}))||null,father:t.find((function(e){return e.name===u.fatherName}))||null};""===a.name||""===a.sex||0===a.born||a.died>(new Date).getFullYear()||+a.died-+a.born>150?(m(Object(O.a)(Object(O.a)({},u),{},{nameInit:!0,sexInit:!0,diedInit:!0})),N(Object(O.a)(Object(O.a)({},p),{},{bornMin:a.born<1400,lifeExpectancy:+a.died-+a.born>150,requiredFieldName:""===a.name,requiredFieldSex:""===a.sex,requiredFieldBorn:!(0!==a.born||u.bornInit),requiredFieldDied:""===a.sex}))):(n([].concat(Object(F.a)(t),[a])),c("/people/"))},children:[Object(j.jsxs)("div",{className:"field is-horizontal",children:[Object(j.jsx)("div",{className:"field-label is-normal",children:Object(j.jsx)("label",{className:"label",htmlFor:"name",children:"Name"})}),Object(j.jsx)("div",{className:"field-body",children:Object(j.jsx)("div",{className:"field is-narrow",children:Object(j.jsxs)("div",{className:"control",children:[Object(j.jsx)("input",{id:"name",autoComplete:"off",className:f()("input","is-small",{"is-danger":p.requiredFieldName}),type:"text",name:"name",value:u.name,onChange:function(e){N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldName:!1})),g(e)},onFocus:function(){return N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldName:!1}))},onBlur:function(){return 0===u.name.length&&N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldName:!0}))}}),p.requiredFieldName&&u.nameInit&&Object(j.jsx)("p",{className:"help is-danger",children:v.requiredField})]})})}),Object(j.jsx)("div",{className:"field-label is-narrow",children:Object(j.jsx)("label",{className:"label",htmlFor:"sex",children:"Sex"})}),Object(j.jsx)("div",{className:"field-body",children:Object(j.jsx)("div",{className:"field",children:Object(j.jsxs)("div",{className:"control",children:[Object(j.jsxs)("label",{className:"radio",children:[Object(j.jsx)("input",{id:"sex",type:"radio",name:"sex",value:"m",checked:"m"===u.sex,onFocus:function(){m(Object(O.a)(Object(O.a)({},u),{},{sexInit:!0}))},onChange:g}),"Male"]}),Object(j.jsxs)("label",{className:"radio",children:[Object(j.jsx)("input",{type:"radio",name:"sex",value:"f",checked:"f"===u.sex,onFocus:function(){m(Object(O.a)(Object(O.a)({},u),{},{sexInit:!0}))},onChange:g}),"Female"]}),p.requiredFieldSex&&Object(j.jsx)("p",{className:"help is-danger",children:v.requiredField})]})})})]}),Object(j.jsxs)("div",{className:"field is-horizontal",children:[Object(j.jsx)("div",{className:"field-label is-normal",children:Object(j.jsx)("label",{className:"label",htmlFor:"born",children:"Born"})}),Object(j.jsx)("div",{className:"field-body",children:Object(j.jsx)("div",{className:"field is-narrow",children:Object(j.jsxs)("div",{className:"control",children:[Object(j.jsx)("input",{id:"born",autoComplete:"off",className:"input is-small",type:"number",min:"0",name:"born",value:u.born,onChange:function(e){g(e),N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldDied:!1}))},onFocus:function(){N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldBorn:!1})),m(Object(O.a)(Object(O.a)({},u),{},{bornInit:!0}))},onBlur:function(){return(0===u.born||""===u.born)&&N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldBorn:!0}))}}),p.requiredFieldBorn&&!u.bornInit&&Object(j.jsx)("p",{className:"help is-danger",children:v.requiredField}),p.bornMin&&u.bornInit&&Object(j.jsx)("p",{className:"help is-danger",children:v.bornMin}),p.bornMax&&u.bornInit&&Object(j.jsx)("p",{className:"help is-danger",children:v.bornMax})]})})}),Object(j.jsx)("div",{className:"field-label is-normal",children:Object(j.jsx)("label",{className:"label",htmlFor:"died",children:"Died"})}),Object(j.jsx)("div",{className:"field-body",children:Object(j.jsx)("div",{className:"field is-narrow",children:Object(j.jsxs)("div",{className:"control",children:[Object(j.jsx)("input",{id:"died",autoComplete:"off",className:"input is-small",type:"number",name:"died",disabled:!u.born,value:u.died,onChange:g,onFocus:function(){N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldDied:!1})),m(Object(O.a)(Object(O.a)({},u),{},{diedInit:!0}))},onBlur:function(){return(0===u.died||""===u.died)&&N(Object(O.a)(Object(O.a)({},p),{},{requiredFieldDied:!0}))}}),p.requiredFieldDied&&u.diedInit&&Object(j.jsx)("p",{className:"help is-danger",children:v.requiredField}),p.diedMin&&Object(j.jsx)("p",{className:"help is-danger",children:v.diedMin}),p.diedMax&&Object(j.jsx)("p",{className:"help is-danger",children:v.diedMax}),p.lifeExpectancy&&Object(j.jsx)("p",{className:"help is-danger",children:v.lifeExpectancyMax})]})})})]}),Object(j.jsxs)("div",{className:"field is-grouped",children:[Object(j.jsx)("div",{className:"control",children:Object(j.jsx)("div",{className:"select",children:Object(j.jsxs)("select",{name:"motherName",value:u.motherName,onChange:g,disabled:!u.born,children:[Object(j.jsx)("option",{disabled:!0,value:"default",children:"Select mother"}),y.map((function(e){return Object(j.jsx)("option",{value:e.name,children:e.name},e.slug)}))]})})}),Object(j.jsx)("div",{className:"control",children:Object(j.jsx)("div",{className:"select",children:Object(j.jsxs)("select",{value:u.fatherName,name:"fatherName",onChange:function(e){g(e)},disabled:!u.born,children:[Object(j.jsx)("option",{disabled:!0,value:"default",children:"Select father"}),M.map((function(e){return Object(j.jsx)("option",{value:e.name,children:e.name},e.slug)}))]})})})]}),Object(j.jsx)("div",{className:"control",style:{margin:"0 auto"},children:Object(j.jsx)("input",{className:"button is-primary",type:"submit",value:"Submit"})})]})})}),C=(n(26),function(){return Object(j.jsx)(u,{children:Object(j.jsx)(l.d,{children:Object(j.jsxs)(l.b,{path:"/",element:Object(j.jsx)(m,{}),children:[Object(j.jsx)(l.b,{index:!0,element:Object(j.jsx)(h,{})}),Object(j.jsx)(l.b,{path:"people",element:Object(j.jsx)(y,{}),children:Object(j.jsx)(l.b,{path:":personId",element:Object(j.jsx)(y,{})})}),Object(j.jsx)(l.b,{path:"/people/new",element:Object(j.jsx)(M,{})})]})})})});a.a.render(Object(j.jsx)(r.a,{children:Object(j.jsx)(C,{})}),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.77b547e0.chunk.js.map